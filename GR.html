<!DOCTYPE html>
<html lang="fr">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>INSA GR | INSA Alumni HDF</title>
  <link rel="icon" type="image/png" href="img/ico.png">
  <link rel="stylesheet" href="styles.css" />
  <!-- FullCalendar CSS si utilisé -->
  <link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="manifest" href="manifest.json">
</head>

<body>

  <!-- HEADER -->

  <!-- SIDEBAR MOBILE -->


  <main class="main-content">
    <h1>Les INSA GR</h1>

    <p>
      INSA GR est une association loi 1901 regroupant les groupes régionaux et internationaux des
      alumni INSA.
      Elle agit par délégation des différentes associations de diplômés des INSA (Lyon, Toulouse, Rennes, CVL,
      Normandie et bientôt Hauts-de-France).
    </p>

    <h2>Une présence nationale et internationale</h2>
    <ul>
      <li>23 groupes régionaux en France métropolitaine</li>
      <li>2 groupes dans les DOM-TOM :
        <ul>
          <li>Amérique : Guadeloupe, Martinique, Guyane</li>
          <li>Océan Indien : Réunion, Mayotte</li>
        </ul>
      </li>
      <li>Des groupes pays et ambassadeurs à l’international</li>
    </ul>

    <h2>Rôle et missions</h2>
    <ul>
      <li>Coordination des groupes régionaux (GR)</li>
      <li>Financement des actions locales</li>
      <li>Développement des synergies entre alumni</li>
      <li>Uniformisation des pratiques : logos, noms, modèles de rapport, etc.</li>
    </ul>

    <h2>Activités organisées</h2>
    <ul>
      <li>Visites d’entreprises / chantiers</li>
      <li>Repas et afterworks entre alumni</li>
      <li>Conférences techniques et généralistes</li>
      <li>Sorties familiales, culturelles, sportives</li>
      <li>Participation à des salons étudiants</li>
      <li>Accueil des élèves INSA</li>
    </ul>

    <p>
      Ces activités sont ouvertes à tous les alumni INSA, cotisants ou non.
      Chaque groupe tient une assemblée annuelle pour élire son bureau (président, trésorier, secrétaire…).
    </p>
    <h2>Composition des bureaux des groupes régionaux (Liste au 01/08/25)</h2>
    <div id="output"></div>

  </main>


  <!-- FOOTER -->


  <style>
    /* Images / layout génériques */
    img {
      max-width: 100%;
      height: auto;
      display: block;
    }

    /* Conteneur du tableau généré */
    #output {
      overflow-x: auto;
      /* scroll horizontal si besoin */
      -webkit-overflow-scrolling: touch;
    }

    /* Style de base du tableau (desktop) */
    #output table {
      border-collapse: collapse;
      width: 100%;
      font-family: Arial, sans-serif;
      table-layout: auto;
      /* évite les colonnes trop larges */
      word-break: break-word;
      /* évite les débordements */
    }

    #output th,
    #output td {
      border: 1px solid #ddd;
      padding: 8px;
      text-align: center;
      vertical-align: middle;
    }

    #output th {
      background-color: #f4f4f4;
      font-weight: bold;
    }

    #output tr:nth-child(even) {
      background-color: #fafafa;
    }

    #output tr:hover {
      background-color: #e0f7fa;
    }

    /* HEADER collant si thead présent (généré par xlsx) */
    #output thead th {
      position: sticky;
      top: 0;
      z-index: 1;
    }

    /* ======= Mobile ======= */
    @media (max-width: 640px) {

      /* Réduction douce des tailles et espaces */
      #output table {
        font-size: 12px;
      }

      /* ← “petit” conforme à ta demande */
      #output th,
      #output td {
        padding: 6px 4px;
      }

      /* Allège un peu l’en-tête */
      #output th {
        font-weight: 600;
      }

      /* Option : rend le tableau encore plus compact si beaucoup de colonnes */
      .compact #output table {
        font-size: 11px;
      }
    }
  </style>


  <!-- Scripts -->
  <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.js"></script>
  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('js/sw.js')
        .then(() => console.log('Service Worker enregistré'))
        .catch(err => console.log('Erreur SW :', err));
    }
  </script>
  <script src="js/script.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
  <script>
    async function loadExcel() {
      const response = await fetch("listeGRs010825.xls");
      const arrayBuffer = await response.arrayBuffer();
      const data = new Uint8Array(arrayBuffer);
      const workbook = XLSX.read(data, { type: "array" });
      const sheet = workbook.Sheets[workbook.SheetNames[0]];

      const html = XLSX.utils.sheet_to_html(sheet, { editable: false, header: "", footer: "" });
      const cleaned = html.replace(/<style[^>]*>[\s\S]*?<\/style>/gi, "");
      document.getElementById("output").innerHTML = cleaned;

      /* --- NEW: améliore l’accessibilité et le responsive --- */
      const tbl = document.querySelector('#output table');
      if (tbl) {
        tbl.setAttribute('role', 'table');
        tbl.setAttribute('aria-label', 'Composition des bureaux des groupes régionaux');
        tbl.classList.add('gr-table');
      }
    }
    loadExcel();
  </script>
</body>


</html>